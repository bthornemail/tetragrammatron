<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Fano Merkaba GLB Export Demo</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      background: #0066cc;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 10px 5px;
    }
    button:hover {
      background: #0052a3;
    }
    pre {
      background: #f5f5f5;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    #preview {
      border: 1px solid #ccc;
      padding: 15px;
      margin: 20px 0;
      background: #fafafa;
    }
    .success {
      color: #00aa00;
      font-weight: bold;
    }
    .info {
      color: #0066cc;
    }
  </style>
</head>
<body>
  <h1>Fano Plane ‚Üí Merkaba 3D Projection</h1>

  <p>This demonstrates the GLB (binary glTF) export of the Fano plane geometry as a <strong>Merkaba</strong> (dual tetrahedron) structure, aligned with the octonionic multiplication table.</p>

  <h2>Merkaba Geometry</h2>
  <div id="preview">
    <p><strong>7 vertices</strong> (imaginary octonion units e‚ÇÅ...e‚Çá):</p>
    <pre id="vertices"></pre>
    <p><strong>21 edges</strong> (3 edges √ó 7 Fano lines):</p>
    <pre id="edges"></pre>
  </div>

  <h2>Export</h2>
  <button onclick="exportGLB()">üì¶ Generate GLB File</button>
  <button onclick="showJSON()">üìÑ Show glTF JSON</button>

  <div id="output"></div>

  <h2>What is a Merkaba?</h2>
  <p>The Merkaba (or Mer-Ka-Ba) is a star tetrahedron: two interlocking tetrahedra forming an 8-pointed 3D star. In Tetragrammatron-OS, this maps to:</p>
  <ul>
    <li><strong>8 total positions</strong>: 7 vertices + 1 center (origin)</li>
    <li><strong>7 vertices</strong> ‚Üí 7 imaginary octonion units</li>
    <li><strong>1 center</strong> ‚Üí real unit e‚ÇÄ (identity)</li>
    <li><strong>Lines</strong> ‚Üí Relations in the Fano plane</li>
  </ul>

  <h2>Viewing the GLB</h2>
  <p>After exporting, you can view the .glb file in:</p>
  <ul>
    <li><a href="https://gltf-viewer.donmccurdy.com/" target="_blank">glTF Viewer by Don McCurdy</a></li>
    <li>Blender (Import ‚Üí glTF 2.0)</li>
    <li>Any AR/VR app that supports glTF</li>
    <li>three.js GLTFLoader</li>
  </ul>

  <script type="module">
    import {
      MERKABA_VERTICES,
      FANO_LINES,
      generateMerkabaEdges,
      generateMerkabaGLB,
      encodeGLB,
      exportFanoMerkabaGLB
    } from './fano_merkaba.js';

    // Display geometry info
    const verticesEl = document.getElementById('vertices');
    verticesEl.textContent = MERKABA_VERTICES.map((v, i) =>
      `Point ${i}: [${v.map(n => n.toString().padStart(2)).join(', ')}]`
    ).join('\n');

    const { edges } = generateMerkabaEdges(1.0);
    const edgesEl = document.getElementById('edges');
    edgesEl.textContent = `${edges.length} edges total\n\nExample (first 5):\n` +
      edges.slice(0, 5).map(e =>
        `  [${e.from.map(n => n.toFixed(1)).join(',')}] ‚Üí [${e.to.map(n => n.toFixed(1)).join(',')}]`
      ).join('\n') + '\n  ...';

    window.exportGLB = function() {
      const glbData = exportFanoMerkabaGLB();
      const blob = new Blob([glbData], { type: 'model/gltf-binary' });
      const url = URL.createObjectURL(blob);

      const outputEl = document.getElementById('output');
      outputEl.innerHTML = `
        <p class="success">‚úì GLB file generated successfully!</p>
        <p class="info">Size: ${glbData.byteLength} bytes</p>
        <p><a href="${url}" download="fano_merkaba.glb">
          <button>üíæ Download fano_merkaba.glb</button>
        </a></p>
        <p><small>Upload to <a href="https://gltf-viewer.donmccurdy.com/" target="_blank">glTF Viewer</a> to visualize in 3D</small></p>
      `;
    };

    window.showJSON = function() {
      const { gltf } = generateMerkabaGLB();
      const outputEl = document.getElementById('output');
      outputEl.innerHTML = `
        <h3>glTF JSON Structure</h3>
        <pre>${JSON.stringify(gltf, null, 2)}</pre>
      `;
    };
  </script>
</body>
</html>
